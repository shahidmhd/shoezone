<!-- Breadcrumb Begin -->
<div class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-6">
                <div class="breadcrumb__links">
                    <a href="./index.html"><i class="fa fa-home"></i> Home</a>
                    <span>Orders</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Breadcrumb End -->
<section class="shop-cart spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="shop__cart__table">
                    <% for(var i=0; i < 1; i++) { %> 
<div class="card">
    <div class="card-body">
      <div class="container mb-5 mt-3">
        <div class="row d-flex align-items-baseline">
          <div class="col-xl-7">
            <p style="color: #010811;font-size: 20px;">Invoice >> <strong>ID:<%=orderdetails[i]._id%></strong></p>
          </div>
          <div class="col-xl-3 float-end">
            <a class="btn btn-light text-capitalize border-0" data-mdb-ripple-color="dark"><i
                class="fa fa-print text-primary btn_print" id="btn_print"></i> Print</a>
            <a class="btn btn-light text-capitalize" onclick="export_data()" data-mdb-ripple-color="dark"><i class="fa  fa-file text-primary"
            ></i> Export</a>
          </div>
          <hr>
        </div>
  
        <div class="container">
          <div class="col-md-12">
            <div class="text-center">
              <i class="fab fa-mdb fa-4x ms-0" style="color:#5d9fc5 ;"></i>
              <p class="pt-0">prooduct details</p>
            </div>
  
          </div>
  
  
          <div class="row">
            <div class="col-xl-8">
              <ul class="list-unstyled">
                <li class="text-muted" >To: <span style="color:#2369c5;"><%=orderdetails[i].deliverydetails.firstName%><span> </span><%=orderdetails[i].deliverydetails. lastName%></span></li>
                <li class="text-muted"><%=orderdetails[i].deliverydetails.address%>,<%=orderdetails[i].deliverydetails.city%></li>
                <li class="text-muted"><%=orderdetails[i].deliverydetails.district%>,PIN:<%=orderdetails[i].deliverydetails.pincode%></li>
                <li class="text-muted"><i class="fa fa-phone"></i><%=orderdetails[i].deliverydetails.phone%></li>
              </ul>
            </div>
            <div class="col-xl-4">
              <p class="text-muted">Invoice</p>
              <ul class="list-unstyled">
                <li class="text-muted"><i class="fa fa-circle" style="color:#1f2223 ;"></i> <span
                    class="fw-bold">ID:</span><%=orderdetails[i]._id%></li>
                <li class="text-muted"><i class="fa fa-circle" style="color:#1f2223 ;"></i> <span
                    class="fw-bold">Creation Date: </span> <%=orderdetails[i].date%></li>
                     
                <li class="text-muted"><i class="fa fa-circle" style="color:#1f2223 ;"></i> <span
                    class="me-1 fw-bold">Status:</span><span class="badge bg-warning text-black fw-bold">
                        <%=orderdetails[i].status%></span></li>
                        <% } %>
              </ul>
            </div>
          </div>
  
          <div class="row my-2 mx-1 justify-content-center">
            <table class="table" id="content_table">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">index</th>
                    <th scope="col">name</th>
                    <th scope="col">quantity</th>
                    <th scope="col">price</th>
                    <th scope="col">offer</th>
                    <th scope="col">subtotal</th>
                    <th scope="col">image</th>
                  </tr>
                </thead>
                <tbody>
                    <% for(var i=0; i < orderdetails.length; i++) { %>  
                  <tr>
                    <td><%=i+1%></td>
                    <td><%=orderdetails[i].productdetails.productname%></td>
                    <td><%=orderdetails[i].products.quantity%></td>
                    <td><%=orderdetails[i].productdetails.price%></td>
                    <td><%=orderdetails[i].offer%></td>
                    <td><%=orderdetails[i].subTotal%></td>
                    <td><img src="<%=orderdetails[i].productdetails.imagesurl[0] %>" style="height: 50px;width: 50px;"></td>
                  </tr>
                  <% } %>
                </tbody>
              </table>
          </div>
          <div class="row">
            <div class="col-xl-8">
  
            </div>
            <div class="col-xl-3">
              <ul class="list-unstyled">
                <!-- <li class="text-muted ms-3"><span class="text-black me-4">SubTotal</span>$1110</li> -->
                <!-- <li class="text-muted ms-3 mt-2"><span class="text-black me-4">Tax(15%)</span>$111</li> -->
              </ul>
              <p class="text-black float-start"><span class="text-black me-3"> Total Amount :</span><span
                  style="font-size: 25px;"><%=orderdetails[0].total%></span></p>
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-xl-10">
              <p style="color: #010811; font-size: medium; font-weight: 500;">Thank you for your purchase</p>
            </div>
              <div class="row">
            <!-- <a href="/orders" class="btn btn-primary text-capitalize"
                style="background-color:#f80616 ;margin-left: 1em;">CANCEL</a> -->
            <a href="/orders" class="btn btn-primary text-capitalize"
                style="background-color:#1180e8 ;margin-left: 1em;">BACK</a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  </div>
  </div>
  </div>
  </div>
  </section>


  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"
  integrity="sha512-z8oDcdy0YCXeQb0q3AEq8e/vWVZvH/6UuV7x/8zUbwH6wPxx6/EjN7I1MN8WnJGZv+PluU7xJIR6aM8fMhhJ6w=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>

<script>
  $(document).ready(function ($) {
    $(document).on("click", ".btn_print", function (event) {
      event.preventDefault();
      var element = document.getElementById("content_table");
      let randomNumber = Math.floor(Math.random() * (10000000000 - 1)) + 1;
      var opt = {
        margin: 0,
        filename: "SalesReport" + randomNumber + ".pdf",
        html2canvas: { scale: 10 },
        jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
      };

      html2pdf().set(opt).from(element).save();
    });
  });

  function export_data() {
    let data = document.getElementById("content_table");
    var fp = XLSX.utils.table_to_book(data, { sheet: "vishal" });
    XLSX.write(fp, {
      bookType: "xlsx",
      type: "base64",
    });
    XLSX.writeFile(fp, "test.xlsx");
  }
</script>